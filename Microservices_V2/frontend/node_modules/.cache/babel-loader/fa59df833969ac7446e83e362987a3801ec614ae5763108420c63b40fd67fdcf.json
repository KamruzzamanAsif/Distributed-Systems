{"ast":null,"code":"import _regeneratorRuntime from\"/home/vamps/Desktop/Microservices/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/vamps/Desktop/Microservices/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/vamps/Desktop/Microservices/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import Navbar from\"../components/navbar\";import Post from\"../components/post\";import AddPost from\"../components/addPost\";import React,{useState,useEffect}from'react';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Home=function Home(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),notifications=_useState4[0],setNotifications=_useState4[1];var fetchPosts=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var token,headers,response,filteredPosts;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;// Retrieve the JWT token from localStorage\ntoken=localStorage.getItem('token');// Set up headers with the JWT token\nheaders={Authorization:token?\"\".concat(token):''// Include the token if available\n};_context.next=5;return axios.get('http://localhost/post/posts',{headers:headers});case 5:response=_context.sent;// setPosts(response.data.posts);\nfilteredPosts=response.data.posts.filter(function(post){return post.user_email!==localStorage.getItem('email');});setPosts(filteredPosts);_context.next=14;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.error('Error fetching posts:',_context.t0);// Check for a 401 Unauthorized response from the server\nif(_context.t0.response&&_context.t0.response.status===401){// Use window.location.href to navigate to the signin page\nwindow.location.href='/';}case 14:case\"end\":return _context.stop();}},_callee,null,[[0,10]]);}));return function fetchPosts(){return _ref.apply(this,arguments);};}();useEffect(function(){// Fetch posts after the component mounts\nfetchPosts();// Fetch posts every 5 seconds (5000 milliseconds)\nvar interval=setInterval(fetchPosts,5000);// Clean up the interval when the component unmounts to avoid memory leaks\nreturn function(){return clearInterval(interval);};},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-[#f4f4f5]\",children:/*#__PURE__*/_jsxs(\"main\",{className:\"container mx-auto p-4\",children:[/*#__PURE__*/_jsx(AddPost,{}),posts.map(function(post){return/*#__PURE__*/_jsx(Post,{user_name:post.user_name,content:post.content,imageName:post.image_name},post.id);})]})})]});};export default Home;","map":{"version":3,"names":["Navbar","Post","AddPost","React","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Home","_useState","_useState2","_slicedToArray","posts","setPosts","_useState3","_useState4","notifications","setNotifications","fetchPosts","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","token","headers","response","filteredPosts","wrap","_callee$","_context","prev","next","localStorage","getItem","Authorization","concat","get","sent","data","filter","post","user_email","t0","console","error","status","window","location","href","stop","apply","arguments","interval","setInterval","clearInterval","children","className","map","user_name","content","imageName","image_name","id"],"sources":["/home/vamps/Desktop/Microservices/frontend/src/pages/Home.jsx"],"sourcesContent":["import Navbar from \"../components/navbar\";\nimport Post from \"../components/post\";\nimport AddPost from \"../components/addPost\";\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\n\nconst Home = () => {\n  const [posts, setPosts] = useState([]);\n  const [notifications, setNotifications] = useState([]);\n\n  const fetchPosts = async () => {\n    try {\n      // Retrieve the JWT token from localStorage\n      const token = localStorage.getItem('token');\n\n      // Set up headers with the JWT token\n      const headers = {\n        Authorization: token ? `${token}` : '', // Include the token if available\n      };\n\n      const response = await axios.get('http://localhost/post/posts', { headers });\n\n      // setPosts(response.data.posts);\n      const filteredPosts = response.data.posts.filter((post) => post.user_email !== localStorage.getItem('email'));\n      setPosts(filteredPosts);\n    } catch (error) {\n      console.error('Error fetching posts:', error);\n\n      // Check for a 401 Unauthorized response from the server\n      if (error.response && error.response.status === 401) {\n        // Use window.location.href to navigate to the signin page\n        window.location.href = '/';\n      }\n    }\n  };\n\n  useEffect(() => {\n    // Fetch posts after the component mounts\n    fetchPosts();\n\n    // Fetch posts every 5 seconds (5000 milliseconds)\n    const interval = setInterval(fetchPosts, 5000);\n\n    // Clean up the interval when the component unmounts to avoid memory leaks\n    return () => clearInterval(interval);\n  }, []);\n\n  return (\n    <>\n      <Navbar />\n\n      <div className=\"bg-[#f4f4f5]\">\n        <main className=\"container mx-auto p-4\">\n          <AddPost />\n\n          {posts.map((post) => (\n            <Post\n              key={post.id}\n              user_name={post.user_name}\n              content={post.content}\n              imageName={post.image_name}\n            />\n          ))}\n        </main>\n      </div>\n    </>\n  );\n}\n\nexport default Home;\n"],"mappings":"gZAAA,MAAO,CAAAA,MAAM,KAAM,sBAAsB,CACzC,MAAO,CAAAC,IAAI,KAAM,oBAAoB,CACrC,MAAO,CAAAC,OAAO,KAAM,uBAAuB,CAC3C,MAAO,CAAAC,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,MAAO,CAAAC,KAAK,KAAM,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,gCAAAC,QAAA,IAAAC,SAAA,yBAE1B,GAAM,CAAAC,IAAI,CAAG,QAAP,CAAAA,IAAIA,CAAA,CAAS,CACjB,IAAAC,SAAA,CAA0BV,QAAQ,CAAC,EAAE,CAAC,CAAAW,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAA/BG,KAAK,CAAAF,UAAA,IAAEG,QAAQ,CAAAH,UAAA,IACtB,IAAAI,UAAA,CAA0Cf,QAAQ,CAAC,EAAE,CAAC,CAAAgB,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAA/CE,aAAa,CAAAD,UAAA,IAAEE,gBAAgB,CAAAF,UAAA,IAEtC,GAAM,CAAAG,UAAU,6BAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAA,MAAAC,KAAA,CAAAC,OAAA,CAAAC,QAAA,CAAAC,aAAA,QAAAN,mBAAA,GAAAO,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAAAF,QAAA,CAAAC,IAAA,GAEf;AACMP,KAAK,CAAGS,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAE3C;AACMT,OAAO,CAAG,CACdU,aAAa,CAAEX,KAAK,IAAAY,MAAA,CAAMZ,KAAK,EAAK,EAAI;AAC1C,CAAC,CAAAM,QAAA,CAAAE,IAAA,SAEsB,CAAA/B,KAAK,CAACoC,GAAG,CAAC,6BAA6B,CAAE,CAAEZ,OAAO,CAAPA,OAAQ,CAAC,CAAC,QAAtEC,QAAQ,CAAAI,QAAA,CAAAQ,IAAA,CAEd;AACMX,aAAa,CAAGD,QAAQ,CAACa,IAAI,CAAC3B,KAAK,CAAC4B,MAAM,CAAC,SAACC,IAAI,QAAK,CAAAA,IAAI,CAACC,UAAU,GAAKT,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,GAAC,CAC7GrB,QAAQ,CAACc,aAAa,CAAC,CAACG,QAAA,CAAAE,IAAA,kBAAAF,QAAA,CAAAC,IAAA,IAAAD,QAAA,CAAAa,EAAA,CAAAb,QAAA,aAExBc,OAAO,CAACC,KAAK,CAAC,uBAAuB,CAAAf,QAAA,CAAAa,EAAO,CAAC,CAE7C;AACA,GAAIb,QAAA,CAAAa,EAAA,CAAMjB,QAAQ,EAAII,QAAA,CAAAa,EAAA,CAAMjB,QAAQ,CAACoB,MAAM,GAAK,GAAG,CAAE,CACnD;AACAC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAG,GAAG,CAC5B,CAAC,yBAAAnB,QAAA,CAAAoB,IAAA,MAAA3B,OAAA,iBAEJ,kBAxBK,CAAAL,UAAUA,CAAA,SAAAC,IAAA,CAAAgC,KAAA,MAAAC,SAAA,OAwBf,CAEDpD,SAAS,CAAC,UAAM,CACd;AACAkB,UAAU,CAAC,CAAC,CAEZ;AACA,GAAM,CAAAmC,QAAQ,CAAGC,WAAW,CAACpC,UAAU,CAAE,IAAI,CAAC,CAE9C;AACA,MAAO,kBAAM,CAAAqC,aAAa,CAACF,QAAQ,CAAC,GACtC,CAAC,CAAE,EAAE,CAAC,CAEN,mBACEhD,KAAA,CAAAE,SAAA,EAAAiD,QAAA,eACErD,IAAA,CAACR,MAAM,GAAE,CAAC,cAEVQ,IAAA,QAAKsD,SAAS,CAAC,cAAc,CAAAD,QAAA,cAC3BnD,KAAA,SAAMoD,SAAS,CAAC,uBAAuB,CAAAD,QAAA,eACrCrD,IAAA,CAACN,OAAO,GAAE,CAAC,CAEVe,KAAK,CAAC8C,GAAG,CAAC,SAACjB,IAAI,qBACdtC,IAAA,CAACP,IAAI,EAEH+D,SAAS,CAAElB,IAAI,CAACkB,SAAU,CAC1BC,OAAO,CAAEnB,IAAI,CAACmB,OAAQ,CACtBC,SAAS,CAAEpB,IAAI,CAACqB,UAAW,EAHtBrB,IAAI,CAACsB,EAIX,CAAC,EACH,CAAC,EACE,CAAC,CACJ,CAAC,EACN,CAAC,CAEP,CAAC,CAED,cAAe,CAAAvD,IAAI"},"metadata":{},"sourceType":"module","externalDependencies":[]}