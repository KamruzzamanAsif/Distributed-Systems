{"ast":null,"code":"import _regeneratorRuntime from\"/home/vamps/Desktop/Microservices/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/vamps/Desktop/Microservices/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/vamps/Desktop/Microservices/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import axios from'axios';import Navbar from\"../components/navbar\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var NotificationPage=function NotificationPage(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),notifications=_useState2[0],setNotifications=_useState2[1];var fetchNotifications=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var token,headers,response,filteredNotifications;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;// Retrieve the JWT token from localStorage\ntoken=localStorage.getItem('token');// Set up headers with the JWT token\nheaders={Authorization:token?\"\".concat(token):''// Include the token if available\n};_context.next=5;return axios.get('http://localhost/notification/notifications',{headers:headers});case 5:response=_context.sent;filteredNotifications=response.data.notifications.filter(function(notification){return notification.user_email!==localStorage.getItem('email');});setNotifications(filteredNotifications);_context.next=14;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.error('Error fetching notifications:',_context.t0);// Check for a 401 Unauthorized response from the server\nif(_context.t0.response&&_context.t0.response.status===401){// Use window.location.href to navigate to the signin page\nwindow.location.href='/';}case 14:case\"end\":return _context.stop();}},_callee,null,[[0,10]]);}));return function fetchNotifications(){return _ref.apply(this,arguments);};}();useEffect(function(){fetchNotifications();// Fetch notifications every 5 seconds (5000 milliseconds)\nvar interval=setInterval(fetchNotifications,5000);// Clean up the interval when the component unmounts to avoid memory leaks\nreturn function(){return clearInterval(interval);};},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto p-4\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-semibold mb-4\",children:\"Notifications\"}),notifications.map(function(notification){return/*#__PURE__*/_jsx(\"div\",{className:\"bg-orange-50 rounded-lg shadow p-4 mb-4\",children:/*#__PURE__*/_jsx(\"p\",{children:notification.message})},notification.notification_id);})]})]});};export default NotificationPage;","map":{"version":3,"names":["React","useState","useEffect","axios","Navbar","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","NotificationPage","_useState","_useState2","_slicedToArray","notifications","setNotifications","fetchNotifications","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","token","headers","response","filteredNotifications","wrap","_callee$","_context","prev","next","localStorage","getItem","Authorization","concat","get","sent","data","filter","notification","user_email","t0","console","error","status","window","location","href","stop","apply","arguments","interval","setInterval","clearInterval","children","className","map","message","notification_id"],"sources":["/home/vamps/Desktop/Microservices/frontend/src/pages/notification.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport Navbar from \"../components/navbar\";\n\nconst NotificationPage = () => {\n  const [notifications, setNotifications] = useState([]);\n\n  const fetchNotifications = async () => {\n    try {\n      // Retrieve the JWT token from localStorage\n      const token = localStorage.getItem('token');\n\n      // Set up headers with the JWT token\n      const headers = {\n        Authorization: token ? `${token}` : '', // Include the token if available\n      };\n      const response = await axios.get('http://localhost/notification/notifications', { headers });\n      const filteredNotifications = response.data.notifications.filter(\n        (notification) => notification.user_email !== localStorage.getItem('email')\n      );\n      setNotifications(filteredNotifications);\n    } catch (error) {\n      console.error('Error fetching notifications:', error);\n\n      // Check for a 401 Unauthorized response from the server\n      if (error.response && error.response.status === 401) {\n        // Use window.location.href to navigate to the signin page\n        window.location.href = '/';\n      }\n    }\n  };\n\n  useEffect(() => {\n    fetchNotifications();\n\n    // Fetch notifications every 5 seconds (5000 milliseconds)\n    const interval = setInterval(fetchNotifications, 5000);\n\n    // Clean up the interval when the component unmounts to avoid memory leaks\n    return () => clearInterval(interval);\n  }, []);\n\n  return (\n    <>\n      <Navbar />\n\n      <div className=\"container mx-auto p-4\">\n        <h1 className=\"text-2xl font-semibold mb-4\">Notifications</h1>\n        {notifications.map((notification) => (\n          <div key={notification.notification_id} className=\"bg-orange-50 rounded-lg shadow p-4 mb-4\">\n            <p>{notification.message}</p>\n          </div>\n        ))}\n      </div>\n    </>\n  );\n};\n\nexport default NotificationPage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}